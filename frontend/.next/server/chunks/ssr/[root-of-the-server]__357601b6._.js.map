{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/ha%20manh%20cuong/work/ctm/frontend/src/lib/api/api.ts"],"sourcesContent":["import { toast } from \"react-toastify\";\r\n\r\nconst BASE_URL = process.env.NEXT_PUBLIC_BASE_URL_CUSTOMERS || \"\";\r\n\r\n// Flag để track toast đã được hiển thị hay chưa\r\nlet sessionExpiredToastShown = false;\r\n\r\n// Function để reset flag khi user login lại\r\nexport function resetSessionExpiredFlag() {\r\n    sessionExpiredToastShown = false;\r\n}\r\n\r\nexport function buildURIWithQueries(\r\n    path: string,\r\n    queries?: { [key: string]: any }\r\n): string {\r\n    if (!queries || Object.keys(queries).length === 0) {\r\n        return path;\r\n    }\r\n\r\n    const params = new URLSearchParams();\r\n    Object.entries(queries).forEach(([key, value]) => {\r\n        if (value) {\r\n            if (Array.isArray(value)) {\r\n                value.forEach((val) => {\r\n                    params.append(key, String(val));\r\n                });\r\n            } else {\r\n                params.append(key, String(value));\r\n            }\r\n        }\r\n        if (typeof value === \"boolean\") {\r\n            params.append(key, value ? \"true\" : \"false\");\r\n        }\r\n    });\r\n\r\n    const queryString = params.toString();\r\n\r\n    return queryString ? `${path}?${queryString}` : path;\r\n}\r\n\r\nexport async function apiFetch(uri: string, options?: any) {\r\n    const accessToken = sessionStorage.getItem(\"accessToken\");\r\n\r\n    const res = await fetch(`${BASE_URL}/${uri}`, {\r\n        ...options,\r\n        headers: {\r\n            Authorization: `Bearer ${accessToken}`,\r\n            ...options.headers,\r\n        },\r\n    });\r\n\r\n    if (res.status === 401) {\r\n        sessionStorage.removeItem(\"accessToken\");\r\n        window.location.href = \"/login?expired=true\";\r\n        return;\r\n    }\r\n\r\n    return res.json();\r\n}\r\n\r\nexport async function apiFetchFullUrl(fullUrl: string, options?: any) {\r\n    const accessToken =\r\n        typeof window !== \"undefined\"\r\n            ? localStorage.getItem(\"accessToken\")\r\n            : null;\r\n    const res = await fetch(fullUrl, {\r\n        ...options,\r\n        headers: {\r\n            Authorization: `Bearer ${accessToken}`,\r\n            ...options.headers,\r\n        },\r\n    });\r\n\r\n    if (res.status === 401) {\r\n        if (typeof window !== \"undefined\") {\r\n            localStorage.removeItem(\"accessToken\");\r\n            window.location.href = \"/login?expired=true\";\r\n        }\r\n        return;\r\n    }\r\n\r\n    return res.json();\r\n}\r\n\r\nconst BASE_URL_SITES = process.env.NEXT_PUBLIC_BASE_URL_SITES || \"\";\r\n\r\nexport async function apiFetchSites(uri: string, options?: any) {\r\n    try {\r\n        if (!BASE_URL_SITES) {\r\n            console.error(\"BASE_URL_SITES is not configured\");\r\n            return null;\r\n        }\r\n\r\n        const url = `${BASE_URL_SITES}${uri}`;\r\n        const res = await fetch(url, {\r\n            ...options,\r\n            headers: {\r\n                ...options?.headers,\r\n            },\r\n        });\r\n\r\n        if (!res.ok) {\r\n            console.log(`HTTP error! status: ${res.status}`);\r\n            return null;\r\n        }\r\n\r\n        const resjson = await res.json();\r\n        if (resjson.status === 400) {\r\n            toast.error(resjson.message || \"Lỗi khi lấy dữ liệu\");\r\n        }\r\n        return resjson.data;\r\n    } catch (error) {\r\n        console.log(\"apiFetchSites error:\", error);\r\n        return null;\r\n    }\r\n}\r\n\r\nconst BASE_URL_CUSTOMERS = process.env.NEXT_PUBLIC_BASE_URL_CUSTOMERS || \"\";\r\n\r\nexport async function apiFetchCustomers(uri: string, options?: any) {\r\n    try {\r\n        if (!BASE_URL_CUSTOMERS) {\r\n            console.error(\"BASE_URL_CUSTOMERS is not configured\");\r\n            return null;\r\n        }\r\n\r\n        const accessToken =\r\n            typeof window !== \"undefined\"\r\n                ? localStorage.getItem(\"accessToken\")\r\n                : null;\r\n        const url = `${BASE_URL_CUSTOMERS}${uri}`;\r\n        const res = await fetch(url, {\r\n            ...options,\r\n            headers: {\r\n                Authorization: `Bearer ${accessToken}`,\r\n                \"Secret-Key\": `${process.env.NEXT_PUBLIC_SECRET_KEY_CUSTOMERS}`,\r\n                ...options?.headers,\r\n            },\r\n        });\r\n\r\n        const resjson = await res.json();\r\n\r\n        // Xử lý JWT expired hoặc unauthorized\r\n        if (\r\n            resjson.msg === \"jwt expired\" ||\r\n            resjson.status === 401 ||\r\n            res.status === 401\r\n        ) {\r\n            if (typeof window !== \"undefined\") {\r\n                localStorage.removeItem(\"accessToken\");\r\n\r\n                // Chỉ hiển thị toast 1 lần duy nhất\r\n                if (!sessionExpiredToastShown) {\r\n                    sessionExpiredToastShown = true;\r\n                    toast.error(\r\n                        \"Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại.\"\r\n                    );\r\n                    setTimeout(() => {\r\n                        window.location.href = \"/customers/login?expired=true\";\r\n                    }, 3000); // Delay 1s để user đọc được toast\r\n                }\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (!res.ok) {\r\n            console.log(`HTTP error! status: ${res.status}`);\r\n            return null;\r\n        }\r\n\r\n        if (resjson.status === 400) {\r\n            toast.error(resjson.msg || \"Lỗi khi lấy dữ liệu\");\r\n        }\r\n        if (resjson.status === 403) {\r\n            toast.error(\r\n                resjson.msg || \"Bạn không có quyền truy cập tài nguyên này\"\r\n            );\r\n        }\r\n        if (resjson.status === 404) {\r\n            toast.error(\"Không tìm thấy tài nguyên yêu cầu\");\r\n        }\r\n        if (resjson.status === 500) {\r\n            toast.error(\"Lỗi máy chủ, vui lòng thử lại sau\");\r\n        }\r\n        return resjson.data;\r\n    } catch (error) {\r\n        console.log(error);\r\n\r\n        return null;\r\n    }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///C:/ha%20manh%20cuong/work/ctm/frontend/src/lib/api/config.ts"],"sourcesContent":["import {\r\n    CurrencyT,\r\n    FixedSiteConfigT,\r\n    LangT,\r\n    SiteConfigT,\r\n} from \"@/types/common.types\";\r\nimport { apiFetchSites, buildURIWithQueries } from \"./api\";\r\n\r\nexport const fixedSiteConfig: FixedSiteConfigT = {\r\n    logo: \"https://ca-ctm.systems.com.vn/styles/logotext.png\",\r\n    policies: {\r\n        title: \"Chính sách\",\r\n        items: [\r\n            {\r\n                title: \"Chính sách bảo mật\",\r\n                link: \"#\",\r\n            },\r\n            {\r\n                title: \"Cơ chế giải quyết tranh chấp\",\r\n                link: \"#\",\r\n            },\r\n            {\r\n                title: \"Quy chế hoạt động\",\r\n                link: \"#\",\r\n            },\r\n        ],\r\n    },\r\n    support: {\r\n        title: \"Hỗ trợ khách hàng\",\r\n        items: [\r\n            {\r\n                title: \"Bán hàng cùng CTM\",\r\n                link: \"#\",\r\n            },\r\n            {\r\n                title: \"Đóng góp ý kiến\",\r\n                link: \"#\",\r\n            },\r\n            {\r\n                title: \"Thông tin Đóng góp ý kiến\",\r\n\r\n                link: \"#\",\r\n            },\r\n            {\r\n                title: \"Tiếp nhận, đánh giá, phản ánh, kiến nghị của tổ chức xã hội\",\r\n                link: \"#\",\r\n            },\r\n            {\r\n                title: \"Danh sách các đánh giá, kiến nghị của tổ chức xã hội\",\r\n                link: \"#\",\r\n            },\r\n        ],\r\n    },\r\n\r\n    socials: [\r\n        {\r\n            icon: \"<i class='fa-brands fa-facebook-f'></i>\",\r\n            key: \"fb_link\",\r\n        },\r\n        {\r\n            icon: \"<i class='fa-brands fa-twitter'></i>\",\r\n            key: \"tw_link\",\r\n        },\r\n        {\r\n            icon: \"<i class='fa-brands fa-instagram'></i>\",\r\n            key: \"instagram_link\",\r\n        },\r\n        {\r\n            icon: \"<i class='fa-brands fa-youtube'></i>\",\r\n            key: \"yt_link\",\r\n        },\r\n    ],\r\n    langs: [\r\n        {\r\n            label: \"English\",\r\n            value: \"en\",\r\n            image: \"/assets/language/en.png\",\r\n        },\r\n        {\r\n            label: \"VietNam \",\r\n            value: \"vi\",\r\n            image: \"/assets/language/vi.png\",\r\n        },\r\n    ],\r\n    currency: [\r\n        {\r\n            label: \"VND\",\r\n            value: \"vnd\",\r\n        },\r\n        {\r\n            label: \"USD\",\r\n            value: \"usd\",\r\n        },\r\n    ],\r\n};\r\n\r\nexport async function getSiteConfig(queries?: {\r\n    [key: string]: any;\r\n}): Promise<any> {\r\n    // const uri = buildURIWithQueries('/config/site', queries);\r\n    // const res = await apiFetch(uri);\r\n    // return res.data;\r\n\r\n    return await apiFetchSites(\"/config/getAll\");\r\n}\r\nexport const getAllLangs = async (): Promise<LangT[]> => {\r\n    // const res = await apiFetch(\"/profile/langs\");\r\n    // return res.data;\r\n    return [\r\n        {\r\n            label: \"English\",\r\n            value: \"en\",\r\n            image: \"/assets/language/en.png\",\r\n        },\r\n        {\r\n            label: \"VietNam \",\r\n            value: \"vi\",\r\n            image: \"/assets/language/vi.png\",\r\n        },\r\n    ];\r\n};\r\nexport const getAllLangsByUrl = async (url: string): Promise<LangT[]> => {\r\n    // const res = await apiFetchFullUrl(url);\r\n    // return res.data;\r\n    return [\r\n        {\r\n            label: \"English\",\r\n            value: \"en\",\r\n            image: \"/assets/language/en.png\",\r\n        },\r\n        {\r\n            label: \"VietNam\",\r\n            value: \"vi\",\r\n            image: \"/assets/language/vi.png\",\r\n        },\r\n    ];\r\n};\r\nexport const getAllCurrencies = async (): Promise<CurrencyT[]> => {\r\n    // const res = await apiFetch(\"/profile/currencies\");\r\n    // return res.data;\r\n    return [\r\n        {\r\n            label: \"VND\",\r\n            value: \"vnd\",\r\n        },\r\n        {\r\n            label: \"USD\",\r\n            value: \"usd\",\r\n        },\r\n    ];\r\n};\r\nexport const getAllCurrenciesByUrl = async (\r\n    url: string\r\n): Promise<CurrencyT[]> => {\r\n    // const res = await apiFetchFullUrl(url);\r\n    // return res.data;\r\n    return [\r\n        {\r\n            label: \"VND\",\r\n            value: \"vnd\",\r\n        },\r\n        {\r\n            label: \"USD\",\r\n            value: \"usd\",\r\n        },\r\n    ];\r\n};\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAMA;;AAEO,MAAM,kBAAoC;IAC7C,MAAM;IACN,UAAU;QACN,OAAO;QACP,OAAO;YACH;gBACI,OAAO;gBACP,MAAM;YACV;YACA;gBACI,OAAO;gBACP,MAAM;YACV;YACA;gBACI,OAAO;gBACP,MAAM;YACV;SACH;IACL;IACA,SAAS;QACL,OAAO;QACP,OAAO;YACH;gBACI,OAAO;gBACP,MAAM;YACV;YACA;gBACI,OAAO;gBACP,MAAM;YACV;YACA;gBACI,OAAO;gBAEP,MAAM;YACV;YACA;gBACI,OAAO;gBACP,MAAM;YACV;YACA;gBACI,OAAO;gBACP,MAAM;YACV;SACH;IACL;IAEA,SAAS;QACL;YACI,MAAM;YACN,KAAK;QACT;QACA;YACI,MAAM;YACN,KAAK;QACT;QACA;YACI,MAAM;YACN,KAAK;QACT;QACA;YACI,MAAM;YACN,KAAK;QACT;KACH;IACD,OAAO;QACH;YACI,OAAO;YACP,OAAO;YACP,OAAO;QACX;QACA;YACI,OAAO;YACP,OAAO;YACP,OAAO;QACX;KACH;IACD,UAAU;QACN;YACI,OAAO;YACP,OAAO;QACX;QACA;YACI,OAAO;YACP,OAAO;QACX;KACH;AACL;AAEO,eAAe,cAAc,OAEnC;IACG,4DAA4D;IAC5D,mCAAmC;IACnC,mBAAmB;IAEnB,OAAO,MAAM,IAAA,yIAAa,EAAC;AAC/B;AACO,MAAM,cAAc;IACvB,gDAAgD;IAChD,mBAAmB;IACnB,OAAO;QACH;YACI,OAAO;YACP,OAAO;YACP,OAAO;QACX;QACA;YACI,OAAO;YACP,OAAO;YACP,OAAO;QACX;KACH;AACL;AACO,MAAM,mBAAmB,OAAO;IACnC,0CAA0C;IAC1C,mBAAmB;IACnB,OAAO;QACH;YACI,OAAO;YACP,OAAO;YACP,OAAO;QACX;QACA;YACI,OAAO;YACP,OAAO;YACP,OAAO;QACX;KACH;AACL;AACO,MAAM,mBAAmB;IAC5B,qDAAqD;IACrD,mBAAmB;IACnB,OAAO;QACH;YACI,OAAO;YACP,OAAO;QACX;QACA;YACI,OAAO;YACP,OAAO;QACX;KACH;AACL;AACO,MAAM,wBAAwB,OACjC;IAEA,0CAA0C;IAC1C,mBAAmB;IACnB,OAAO;QACH;YACI,OAAO;YACP,OAAO;QACX;QACA;YACI,OAAO;YACP,OAAO;QACX;KACH;AACL","debugId":null}},
    {"offset": {"line": 331, "column": 0}, "map": {"version":3,"sources":["file:///C:/ha%20manh%20cuong/work/ctm/frontend/src/components/features/provider/ConfigProvider.tsx"],"sourcesContent":["\"use client\"\r\nimport { getSiteConfig } from \"@/lib/api/config\";\r\nimport { SiteConfigT } from \"@/types/common.types\";\r\nimport { createContext, useContext, useEffect, useState } from \"react\";\r\n\r\n\r\ntype ConfigContextType = {\r\n  config: SiteConfigT,\r\n  setConfig: (config: SiteConfigT) => void,\r\n}\r\nconst ConfigContext = createContext<ConfigContextType>({\r\n  config: {} as SiteConfigT,\r\n  setConfig: () => { },\r\n})\r\n\r\n\r\nexport default function ConfigProvider({ children }: { children: React.ReactNode }) {\r\n  const [config, setConfig] = useState<SiteConfigT>({} as SiteConfigT);\r\n  const handleFetchConfig = async () => {\r\n    try {\r\n\r\n      const resdata = await getSiteConfig();\r\n      setConfig(resdata);\r\n    } catch (error) {\r\n      console.error(\"❌ Error fetching site config:\", error);\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    handleFetchConfig();\r\n  }, []);\r\n\r\n\r\n\r\n  return (\r\n    <ConfigContext.Provider value={{ config, setConfig }}>\r\n      {children}\r\n    </ConfigContext.Provider>\r\n  )\r\n}\r\n\r\nexport const useConfig = () => useContext(ConfigContext);"],"names":[],"mappings":";;;;;;;AACA;AAEA;AAHA;;;;AAUA,MAAM,8BAAgB,IAAA,sNAAa,EAAoB;IACrD,QAAQ,CAAC;IACT,WAAW,KAAQ;AACrB;AAGe,SAAS,eAAe,EAAE,QAAQ,EAAiC;IAChF,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAc,CAAC;IACnD,MAAM,oBAAoB;QACxB,IAAI;YAEF,MAAM,UAAU,MAAM,IAAA,4IAAa;YACnC,UAAU;QACZ,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iCAAiC;QACjD;IACF;IACA,IAAA,kNAAS,EAAC;QACR;IACF,GAAG,EAAE;IAIL,qBACE,8OAAC,cAAc,QAAQ;QAAC,OAAO;YAAE;YAAQ;QAAU;kBAChD;;;;;;AAGP;AAEO,MAAM,YAAY,IAAM,IAAA,mNAAU,EAAC","debugId":null}}]
}